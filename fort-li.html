<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-item/paper-item-body.html">
<link rel="import" href="../paper-item/paper-item-behavior.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">

<!--
A List Item

Example:

    <forti-li></fort-li>

Example:

    <fort-li>
      <h2>Hello seed-element</h2>
    </fort-li>

@demo demo/fort-li.html
-->

<dom-module id="fort-li" attributes="multi-line">
  <template strip-whitespace>
    <style>
      :host {
        @apply --paper-font-body1;
        position: relative;
        padding: 0;
        display: block;
        box-sizing: border-box;
        line-height: 26px;
        min-height: 48px;
        user-select: none;

        @apply --fort-li-style;
        @apply --fort-li-border-style;
      }

      :host(:focus), :host([focused]) {
        outline: 0;
      }

      /*
       * if host-context is deprecated, a shared behavior could be used to propagate list properties
       * see:  https://github.com/PolymerElements/app-storage/blob/master/app-network-status-behavior.html
       */
      :host-context(fort-list-menu):host(:hover):after {
        @apply --layout-fit;
        background: var(--fort-li-hover-color, currentColor);
        content: '';
        opacity: var(--dark-divider-opacity);
        pointer-events: none;
      }

      :host-context(fort-list-menu):host(:focus):before,
      :host-context(fort-list-menu):host([focused]):before {
        @apply --layout-fit;
        background: var(--fort-li-focus-color, transparent);
        content: '';
        opacity: var(--dark-divider-opacity);
        pointer-events: none;
      }

      :host-context(fort-list-menu):host(:active):after {
        @apply --layout-fit;
        background: var(--fort-li-active-color, currentColor);
        content: '';
        opacity: var(--dark-divider-opacity);
        pointer-events: none;
      }

      :host([odd]):host-context(fort-list[zebra],fort-list-menu[zebra]) {
        background: var(--theme-300-color, #F0F6FA);
      }

      :host-context(fort-list[border],fort-list-menu[border]) #container,
      :host-context(fort-list[double-border],fort-list-menu[double-border]) #container {
        border-bottom: 1px solid var(--fort-list-border-color, rgba(0, 0, 0, 0.06));
      }

      :host-context(fort-list[border],fort-list-menu[border]):host([last-item]) #container,
      :host-context(fort-list[double-border],fort-list-menu[double-border]):host([last-item]) #container {
        border-bottom-color: transparent;
      }

      :host-context(fort-list[double-border],fort-list-menu[double-border]) #container {
        border-top: 1px solid var(--fort-list-double-border-color, rgba(0, 0, 0, 0.12));
      }

      :host-context(fort-list[double-border],fort-list-menu[double-border]):host([first-item]) #container {
        border-top-color: transparent;
      }

      :host-context(fort-list-menu) {
        cursor: pointer;
      }

      :host fort-icon {
        width: var(--paper-item-icon-width, 56px);
        padding: 0;
        color: var(--text-color);
      }

      :host paper-item-body {
        overflow: visible;
        padding: 9px 0;
      }

      :host paper-item-body[two-line] {
        min-height: initial;
      }

      #primary {
        @apply --paper-font-subhead;
        overflow: visible;
      }

      #secondarySlot::slotted(*) {
        @apply --text-secondary;

        white-space: normal;
        max-height: 32px;
        line-height: 16px;
      }

      #footerSlot::slotted(*) {
        @apply --text-secondary;
        position: relative;

        max-height: 40px;
        line-height: 40px;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;

        @apply --fort-li-footer;
      }

      #iconContainer[has-contents] {
        display: flex;
        width: 56px;
        align-items: center;
      }

      #iconSlot::slotted(fort-icon) {
        padding: 0;
      }

      #container {
        display: flex;
        align-items: center;
        padding: 0 16px;
        border: 1px solid transparent;
        min-height: inherit;
        box-sizing: border-box;
      }
    </style>

    <div id="container">
      <div id="iconContainer" has-contents$="[[_hasIcon]]">
        <slot id="iconSlot" name="icon"></slot>
      </div>

      <paper-item-body>
        <div id="primary">
          <slot></slot>
        </div>
        <slot id="secondarySlot" name="secondary"></slot>
      </paper-item-body>

      <slot name="actions"></slot>
    </div>

    <slot id="footerSlot" name="footer"></slot>
  </template>

  <script>
    Polymer(
      {
        is:         'fort-li',
        properties: {
          odd:       {type: Boolean, reflectToAttribute: true, value: false},
          firstItem: {type: Boolean, reflectToAttribute: true, value: false},
          lastItem:  {type: Boolean, reflectToAttribute: true, value: false},
          multiLine: {type: Boolean, value: false},
          _hasIcon:  {type: Boolean}
        },
        behaviors:  [
          Polymer.PaperItemBehavior
        ],
        attached:   function ()
                    {
                      this._hasIcon = this.$.iconSlot.assignedNodes({flatten: true}).length > 0;
                    }
      }
    );
  </script>
</dom-module>
